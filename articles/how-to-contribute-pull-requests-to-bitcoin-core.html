<!--

jon atack bitcoin core developer and protocol researcher

-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <title>jon atack - How to Contribute Pull Requests to Bitcoin Core</title>
    <meta charset="utf-8">
    <base target="_blank">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="/style.css" />
  </head>

  <body>
    <div id="content">
      <div id="right">
        <div class="list">
          <ul>
            <li>
              <a href="/" target="_self">home</a>
            </li>
            <li>
              <a href="/articles" target="_self">articles</a>
            </li>
            <li>
              <a href="/bitcoin.pdf" target="_self">bitcoin white paper</a>
            </li>
            <li>
              <a href="/sponsors" target="_self">sponsors</a>
            </li>
            <li>
              <a href="/contact" target="_self">contact</a>
            </li>
            <li>
              <a href="/donate" target="_self">donate</a>
            </li>
            <li>
              &nbsp;
            </li>
            <li class="small">
              style:<br>
              <a href="https://basicbitch.software" class="small" target="_blank">basicbitch.software</a>
            </li>
          </ul>
        </div>
        <div class="namecap">
          <a href="/" target="_self">&nbsp;jon&nbsp;<br>atack</a>
        </div>
      </div>

      <div id="entry_block">
        <div class="entry">
          <div class="date">Last updated: 30 June 2021</div>
          <div class="body">
            <article>
              <div class="title">How to Contribute Pull Requests to Bitcoin Core</div>

              <h3 id="before-you-begin">BEFORE YOU BEGIN</h3>

              <p>
                This guide builds on the foundation laid by
                <a href="how-to-review-pull-requests-in-bitcoin-core"
                   target="_self">How to Review Pull Requests in Bitcoin Core</a>.
              </p>
              <p>
                Remember that testing issues and reviewing are the most
                effective ways you can contribute as a new contributor (and will
                teach you more about the codebase than opening PRs).
              </p>
              <p>
                When a new contributor is doing review or testing, they stand
                out positively and much more than someone who is opening pull
                requests and doing little to no commensurate review and testing.
              </p>
              <p>
                As
                <a href="https://twitter.com/moneyball" target="_blank">Steve Lee</a>
                of
                <a href="https://squarecrypto.org/" target="_blank">Square Crypto</a>
                wrote to me recently: "If literally all a developer did was
                review hard but important PRs it'd be incredibly valuable."
              </p>
              <p>
                Don't be in a hurry to add to the growing pile of open PRs.
              </p>
              <p>
                A good rule of thumb is to review 5-15 PRs (or solve or test
                5-15 open issues) for every PR you make.
              </p>

              <h3 id="how-to-contribute-pull-requests-to-bitcoin-core">HOW TO CONTRIBUTE PULL REQUESTS TO BITCOIN CORE</h3>

              <p>
                When you do start contributing PRs, here are some guidelines:
              </p>
              <p>
                Aim for quality over quantity and a balance between deep work
                and quick wins.
              </p>
              <p>
                Read and know the Bitcoin Core
                <a href="https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md"
                   target="_blank">Contributing Guide</a>,
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md"
                   target="_blank">Developer Notes</a>
                and
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/productivity.md"
                   target="_blank">Productivity Notes</a>.
              </p>

              <h4 id="what-to-do">What to do</h4>
              <p>
                Choose your contribution carefully to be sure it is desired by
                the maintainers and reviewers; without their approval, you risk
                squandering your time and social capital.
              </p>
              <p>
                The best places to look for good things to do as a new
                contributor are:
                <ul>
                  <li>
                    the
                    <a href="https://github.com/bitcoin/bitcoin/contribute"
                        target="_blank">Contribute</a> page
                  </li>
                  <li>
                    the
                    "<a href="https://github.com/bitcoin/bitcoin/issues?q=is%3aissue+is%3aopen+label%3a%22good+first+issue%22"
                        target="_blank">good first issue</a>" list
                  </li>
                </ul>
              </p>
              <p>
                Good ideas may also be found while doing
                <a href="https://github.com/bitcoin/bitcoin/pulls"
                   target="_blank">PR reviews</a>
                and in
                <a href="https://kiwiirc.com/nextclient/irc.libera.chat"
                   target="_blank" rel="nofollow">#bitcoin-core-dev</a>
                IRC discussions when maintainers or experienced contributors
                mention nice-to-haves.
              </p>
              <p>
                Things to do and fix can also be found by searching for TODO and
                FIXME comments in the codebase. An easy way to do this is to
                run <code>git grep "TODO\|FIXME"</code> on the command line from
                root. Keep in mind that these comments can sometimes be out of
                date.
              </p>

              <h4 id="priorities">Priorities</h4>
              <p>
                Focus on user problems, actual bugs, and "used, but untested"
                methods that affect outcomes and need tests. Bitcoin Core is a
                large, legacy codebase and there are inconsistencies, but it's
                good to keep a healthy perspective on priorities. An item might
                seem fun to contribute, but before opening that PR,
                <a href="on-reviewing-and-helping-those-who-do-it"
                   target="_self">consider the review time you're asking for</a>.
                Because of your PR, is a regression or CVE getting past a lack
                of review elsewhere?
              </p>
              <p>
                <a href="https://github.com/bitcoin/bitcoin/pull/17728#issuecomment-565803646"
                   target="_blank">Try to solve a clearly defined issue with a
                   clear, minimal change</a>.
              </p>
              <p>
                Avoid making trivial refactoring, style cleanup, or spelling
                PRs; these consume valuable contributor and maintainer time,
                often for little gain. Code churn can cause hidden new bugs and
                blurs the code history and git blame. Any code refactoring needs
                substantial motivation, advantages, or simplifications.
              </p>
              <p>
                Do not begin by trying to change consensus code; it is difficult
                and dangerous territory. The goal of Bitcoin Core is to maintain
                the correct consensus on the Bitcoin network — all else is
                secondary.
              </p>
              <p>
                As a general guideline, here are priorities in decreasing order:
                fixing bugs, improving security/test coverage, addressing real
                use cases, doing less/removing code (only when doing nothing
                isn't better), doing more/adding code.
              </p>

              <h4 id="gather-information">Gather information</h4>
              <p>
                Gather context about the change you have in mind. Has it already
                been proposed in the past? Do issues or PRs about it already
                exist? (They probably do.) Sleuth a bit. Search the <code>git
                log -S</code> history. Look at the <code>git blame</code> of the
                code in question and <code>git show</code> / <code>git
                log</code> the commits of the relevant lines. Check the GitHub
                file history. You'll see who understands that part of the
                codebase and can be contacted for questions or review (after
                you've first put in the work to understand it on your own).
              </p>
              <p>
                It may save you a lot of time to consult with relevant people on
                IRC before tackling a difficult project in potentially the wrong
                way, or one that has already been tried and turned out to be a
                dead end for reasons that may not be apparent to you.
              </p>
              <p>
                I sometimes seek Concept ACKs for larger changes at IRC meetings
                (<a href="http://www.erisian.com.au/meetbot/bitcoin-core-dev/2020/bitcoin-core-dev.2020-01-17-19.00.log.html"
                    target="_blank">example</a>)
                as a topic request and discussion. That said, I do it less and
                less, and now quite rarely, because observing discussion on IRC
                and while reviewing pull requests allows seeing needs naturally.
              </p>

              <h4 id="write-test-coverage">Write test coverage</h4>
              <p>
                Test coverage is essential; don't hesitate to write any missing
                <a href="https://github.com/bitcoin/bitcoin/tree/master/src/test" target="_blank">unit</a>,
                <a href="https://github.com/bitcoin/bitcoin/tree/master/test/functional" target="_blank">functional</a>, or
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/fuzzing.md" target="_blank">fuzz</a>
                tests, or improve the
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/benchmarking.md" target="_blank">benchmarks</a>.
              </p>
              <p>
                A Gregory Maxwell warning to test contributors: "Overly exact
                tests have greatly diminished value if their exactitude turns
                them into hyper-active <em>something changed</em> detectors,
                when they would otherwise be more useful as <em>something isn't
                right</em> detectors if constructed more in terms of invariants
                instead of strict behaviour."
              </p>

              <h4 id="write-documentation">Write documentation</h4>
              <p>
                Documentation is important, e.g. high-level documentation of how
                things work and interact, clear and accurate code docs, whether
                a function has a good description and
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#coding-style-doxygen-compatible-comments"
                   target="_blank">Doxygen documentation</a>,
                test logging (both <code>info</code> and <code>debug</code>),
                and so on.
              </p>
              <p>
                Add
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md#release-notes"
                   target="_blank">release notes</a>
                when appropriate. RPC-related release notes should refer to the
                RPC help for details instead of substituting for full
                documentation, for example: "Please refer to the RPC help
                of <code>getbalances</code> for details."
               </p>
              <p>
                To avoid potential merge conflicts, release notes are usually
                added in a separate markdown file in the <code>/doc</code>
                directory named <code>release-notes-&lt;PR_NUMBER&gt;.md</code>,
                not directly in
                <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes.md"
                   target="_blank">doc/release-notes.md</a>.
              </p>

              <p>
                In general, PRs that intelligently improve documentation and
                tests in a well thought-out way tend to be well-received.
              </p>

              <h4 id="hygienic-commits">Hygienic commits</h4>
              <p>
                Make sure each individual commit in your PR is hygienic. Every
                commit must
                <a href="/articles/how-to-compile-bitcoin-core-and-run-the-tests"
                   target="_self">compile successfully</a>
                on its own without warnings, errors, regressions, or test
                failures.
              </p>
              <p>
                This means compiling your PRs with <code>--enable-debug</code>
                passed to your build configuration.  Run
                <code>./configure --help | grep -A1 --enable-debug</code>
                for more info.
              </p>
              <p>
                Set up a CI (continuous integration) on your own GitHub Bitcoin
                repository, so that when you push a branch or commit, the linter
                and CI tests run. It can be a good idea to verify that they are
                all green before opening a PR.  The CI is sometimes slow and
                times out frequently — you may have to look at the logs of
                failing jobs to distinguish between real issues and when you
                just need to restart the job.
              </p>
              <p>When it works,
                <a href="https://bitcoinbuilds.org"
                   rel="nofollow">https://bitcoinbuilds.org</a>
                runs more quickly than the CI (but for the moment it tests fewer
                platforms), so don't hesitate to consult it for quicker feedback
                when you push a PR or changes.
              </p>

              <h4 id="do-it-well">Do it well</h4>
              <p>
                Don't rush. Give your work time to mature, revisit it with fresh
                perspective, and iterate on it a few times before putting it out
                there and asking for others' time. It might be a good rule of
                thumb to write several WIP PRs for each one that you do file.
              </p>
              <p>
                Put the time in to make your PRs as easy to understand and
                review as possible: Code, tests, documentation, good commit
                messages, relevant references, concise explanations, and a
                logical ordering of commits that each build cleanly and pass all
                tests.
              </p>

              <h4 id="timing">Timing</h4>
              <p>
                Consider also the timing of what is going on in the project in
                terms of priorities and releases as well as your current
                status. If you already have a few PRs open it may be best to
                close them or concentrate on having them merged before adding
                yet another PR to the review stack. The idea of limiting open
                PRs to 5 per contributor is occasionally raised; consider not
                exceeding that unless the quality and quantity of your reviews
                (or handling and testing of issues) are also present in equal or
                greater proportion.
              </p>
              <p>
                Give some thought to PR size and scope. Many contributors err on
                the side of making their PRs too large and time-consuming to
                review. It is often better to keep your PRs short and focused to
                make them easier and safer to review. This may require splitting
                your work into several consecutive PRs.
              </p>

              <h4 id="pr-descriptions">PR descriptions</h4>
              <p>
                As described in the Bitcoin Core
                <a href="https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md"
                   target="_blank">contributing guide</a>,
                prefix your PR title with the relevant area
                (e.g. <code>doc</code>, <code>test</code>, <code>rpc</code>, <code>wallet</code>).
              </p>
              <p>
                PR descriptions are important. They "sell" your PR yet are often
                either too terse or too verbose. Write the essentials, then take
                the time to make your PR description brief, clear, even
                <a href="https://www.collinsdictionary.com/dictionary/english/pithy"
                   rel="nofollow">pithy</a>.
              </p>
              <p>
                Don't put @-prefixed usernames in commits and PR descriptions;
                the latter because usernames in the description are copied into
                the merge commit by the merge script. This can cause endless
                annoying notifications for those concerned. An
                <a href="https://github.com/bitcoin-core/bitcoin-maintainer-tools/pull/32" target="_blank">update</a>
                to the merge script now warns maintainers if a merge message
                contains a @username, but it's better not to add them to begin
                with.
              </p>
              <p>
                Don't rely on markdown in your PR description for it to make
                sense, especially strike-through formatting. The Bitcoin Core
                merge script will copy your PR description to git history in the
                merge commit as text, and any formatting will be lost.
              </p>

              <h4 id="say-why">Say why</h4>
              <p>
                PR descriptions need to explain <em>why</em>. Summarizing
                "what" can be good too, but "why" is essential to review because
                if the why doesn't make sense then the what probably doesn't
                matter. Sometimes things seem self-apparent, but when in doubt
                no one was ever hurt by a little more concise explanation.
              </p>

              <h4 id="say-how-to-review-and-test-your-pr">Say how to review and test your PR</h4>
              <p>
                It's a smart habit to give reviewers tips in your PR description
                on how to review and test your changes: "Here's how to review
                this".
              </p>

              <h4 id="rebasing">Rebasing</h4>
              <p>
                It essential to be comfortable with frequently rebasing your
                commits to reorganise or squash them. Rebasing is frequently
                done to keep your commits logical, separate, and easier to
                review. Even better, hygienic — each standing on their own
                without introducing regressions.
              </p>
              <p>
                For simple edits of existing commits, don't hesitate to squash
                your commits before pushing, without waiting for the maintainers
                to ask you to do so.
              </p>

              <p>
                You can sign your commits using the
                <a href="https://github.com/opentimestamps/opentimestamps-client/blob/master/doc/git-integration.md"
                   target="_blank">OpenTimestamps Git Integration</a>.
                It's easy to setup.
              </p>
              <p>
                Remember that every time you comment on your PR after pushing,
                you're sending notifications to the people who previously
                reviewed or commented on it. Respect their time.
              </p>

              <h4 id="getting-review">Getting review</h4>
              <p>
                Learn how to get people to review your work when needed. It's a
                skill.
                <a href="on-reviewing-and-helping-those-who-do-it"
                   target="_self">Review is scarce and valuable -- it's the bottleneck</a>.
              </p>
              <p>
                The best ways to get review are organic: Make sure your work is
                interesting, desired, and done well. Give back by helping others
                and giving review. Give more than you take or ask for; add value
                as best as you can while figuring things out on your own. It's a
                long and sometimes frustrating path but a rewarding one.
              </p>
              <p>
                While waiting for review, the very best thing you can do
                is give review to others. Karma is a thing — and
                reviewing/testing PRs and issues builds your credibility and
                understanding of the codebase and the process.
              </p>
              <p>
                Persistence can pay off. Sometimes a PR succeeds on the second
                or
                <a href="https://github.com/bitcoin/bitcoin/pull/16060" target="_blank">third try</a>
                if the first ones didn't see enough review and if there are
                valid reasons to continue.
              </p>
              <p>
                In this case,
                <a href="https://github.com/bitcoin/bitcoin/pull/16060#issuecomment-494142593">one
                  idea seen in practice</a>
                is to recap various ACKs from the previous PRs, with GitHub
                usernames, to rope in support for the new PR. If you do, be sure
                to do it in a comment — not in a commit message and not in the
                PR description.
              </p>
              <p>
                Ask yourself how others will see your PR. Try to only file PRs
                that people will be motivated to review and that are worth
                merging, for both Bitcoin and your track record. Your PRs will
                receive more attention from the contributors and maintainers and
                be merged more quickly.
              </p>
              <p>
                Scale up your PR contributions gradually in line with your
                ability and understanding of the project, process, and codebase.
              </p>

              <h4 id="keep-reviewing">Keep reviewing</h4>
              <p>
                Continue to do more reviewing and testing than adding PRs to the
                backlog. Reviewing 5 to 15 PRs for every PR you open is a good
                range.
              </p>
              <p>
                If you are a good reviewer and begin building a reputation and
                appreciation for your help in moving the project forward,
                maintainers and other contributors may reciprocate by reviewing
                your work more quickly as well. See these two articles for more:
                <ul>
                  <li>
                    <a href="/articles/on-reviewing-and-helping-those-who-do-it"
                       target="_self">On Reviewing, and Helping Those Who Do It</a>
                  </li>
                  <li>
                    <a href="/articles/how-to-review-pull-requests-in-bitcoin-core"
                       target="_self">How to Review Pull Requests in Bitcoin Core</a>
                  </li>
                </ul>
              </p>
              <p>
                Happy contributing!
              </p>
              <p>Cheers,</p>
              <p>Jon Atack</p>
            </article>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>
